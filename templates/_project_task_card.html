<div id="task-{{ task.id }}"
     class="task {% if task.done %}done{% endif %}"
     data-id="{{ task.id }}"
     data-status="{{ task.status }}">

  <!-- ROW 1: checkbox + text + delete -->
  <div class="task-row task-main" onclick="toggleTask(this.parentElement)">
    <input type="checkbox"
           {% if task.status == "done" %}checked{% endif %}
           onclick="event.stopPropagation()"
           onchange="updateStatus('{{ task.id }}', this.checked ? 'done' : 'open')">

    <div class="task-text">{{ task.text }}</div>

    <button class="icon-btn danger"
            onclick="event.stopPropagation(); eliminateTask('{{ task.id }}')">
      ğŸ—‘
    </button>
  </div>

  <!-- ROW 2: planning -->
  <div class="task-row task-meta">

  
     <!-- START DATE -->
    <label>Start</label>
    <input type="date"
        class="start-date"
        value="{{ task.start_date or '' }}"
        onchange="updatePlanning('{{ task.id }}')">



    <!-- DURATION -->
    <label>Duration</label>
     <input type="number"
       class="duration-days"
       min="1"
       value="{{ task.duration_days or 1 }}"
       onchange="updatePlanning('{{ task.id }}')">

    <span>days</span>

    <!-- DUE -->
    <label>Due</label>
    <span class="due-date">{{ task.due_date }}</span>

    <select onchange="updateDueTime('{{ task.id }}', this.value)">
      {% for h in range(0,24) %}
        <option value="{{ "%02d:00"|format(h) }}"
          {% if task.due_time == "%02d:00"|format(h) %}selected{% endif %}>
          {{ "%02d:00"|format(h) }}
        </option>
      {% endfor %}
    </select>

    <!-- STATUS -->
    <select onchange="updateStatus('{{ task.id }}', this.value)">
      <option value="open" {% if task.status=='open' %}selected{% endif %}>Open</option>
      <option value="in_progress" {% if task.status=='in_progress' %}selected{% endif %}>In Progress</option>
      <option value="done" {% if task.status=='done' %}selected{% endif %}>Done</option>
    </select>
  </div>

  <!-- ğŸ”½ DETAILS (hidden by default) -->
  <div class="task-details">

    <div class="meta">
      ğŸ‘¤ Delegate to:
      <input type="text"
             value="{{ task.delegated_to or '' }}"
             onchange="updateDelegation('{{ task.id }}', this.value)">
    </div>

    <div class="meta">
      ğŸ—‘ Elimination reason:
      <input type="text"
             value="{{ task.elimination_reason or '' }}"
             onchange="updateElimination('{{ task.id }}', this.value)">
    </div>

  </div>
</div>
<div class="task-details">

  <div class="meta">
    â³ Planned hours:
    <input type="number"
           min="0"
           step="0.5"
           value="{{ task.planned_hours or 0 }}"
           onchange="updatePlanned('{{ task.id }}', this.value)">
  </div>

  <div class="meta">
    âœ… Actual hours:
    <input type="number"
           min="0"
           step="0.5"
           value="{{ task.actual_hours or 0 }}"
           onchange="updateActual('{{ task.id }}', this.value)">
  </div>

</div>

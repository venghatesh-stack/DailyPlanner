<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="{{ url_for('static', filename='health.css') }}">
<title>Health Dashboard</title>
</head>

<body>
<div class="health-container">

  <!-- Top Navigation -->
  <div class="nav-icons">
    {% include "_top_nav.html" %}
  </div>

  <!-- Header -->
  <div class="health-header">
    <h2>ğŸ’š Health Dashboard</h2>
    <input type="date" id="health-date">
  </div>

 <div class="habit-summary">

  <div class="habit-circle-wrapper">

    <div class="habit-circle">
      <svg width="120" height="120">
        <circle cx="60" cy="60" r="50"
                stroke="#e5e7eb"
                stroke-width="10"
                fill="none"/>
        <circle cx="60" cy="60" r="50"
                stroke="#2563eb"
                stroke-width="10"
                fill="none"
                stroke-dasharray="314"
                stroke-dashoffset="{{ 314 - (habit_percent * 3.14) }}"
                transform="rotate(-90 60 60)"/>
      </svg>
      <div class="circle-text">{{ habit_percent }}%</div>
    </div>

    <!-- ğŸ”¥ NEW -->
    <div class="weekly-line" id="weeklyAvg"></div>
    <div id="bestHabit" class="best-habit"></div>

  </div>

  <div class="streak-badge" id="streak-badge">
    ğŸ”¥ {{ health_streak }} day streak
  </div>

</div>
  <!-- Main Grid -->
  <div class="health-grid">

    <!-- Metrics Card -->
    <div class="health-card">

      <label>Weight (kg)</label>
      <input type="number" id="weight" step="0.1">

      <label>Sleep (hours)</label>
      <input type="number" id="sleep" step="0.5">

      <label>Mood</label>
      <select id="mood">
        <option>ğŸ˜Š Happy</option>
        <option>ğŸ˜ Neutral</option>
        <option>ğŸ˜ Low</option>
      </select>

      <label>Energy (1â€“10)</label>
      <input type="range" id="energy" min="1" max="10">

      <label>Notes</label>
      <textarea id="health-notes"></textarea>

      <h4>Daily Habits</h4>
      <div id="habitContainer">
        {% for habit in habit_list %}
          <div class="habit-item">
            <label>{{ habit.name }} ({{ habit.unit }})</label>
            <input type="number"
                   step="0.1"
                   value="{{ habit.value }}"
                   data-id="{{ habit.id }}"
                   class="habit-input">
          </div>
        {% endfor %}
      </div>

      <button id="saveBtn" onclick="saveHealth()">Save</button>

    </div>

    <!-- Chart + Monthly Summary Card -->
    <div class="health-card">

      <canvas id="healthChart"></canvas>

      <h4>ğŸ“… Monthly Summary</h4>
      <div id="monthlySummary"></div>

    </div>

    <!-- Heatmap Card -->
    <div class="health-card">
      <h4>ğŸ“Š Activity Heatmap</h4>
      <div id="heatmap"></div>
    </div>

  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='health.js') }}" defer></script>

</body>
</html>
